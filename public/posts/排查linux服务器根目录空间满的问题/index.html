<!DOCTYPE html>
<html lang="zh-CN">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>排查linux服务器根目录空间满的问题 - LenBlog</title><meta name="Description" content="一个基于 Hugo 的个人博客网站"><meta property="og:url" content="http://localhost:1313/posts/%E6%8E%92%E6%9F%A5linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A0%B9%E7%9B%AE%E5%BD%95%E7%A9%BA%E9%97%B4%E6%BB%A1%E7%9A%84%E9%97%AE%E9%A2%98/">
  <meta property="og:site_name" content="LenBlog">
  <meta property="og:title" content="排查linux服务器根目录空间满的问题">
  <meta property="og:description" content="清理linux服务器根目录空间 现象：代码无法复制到新文件，创建的新文件无法正常写入内容，大小保存后为0kb。无法上传新的文件。这说明根目录磁盘空间满了。
排查步骤 检查是否确实根目录空间满：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-07T00:00:00+00:00">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="清理空间">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="排查linux服务器根目录空间满的问题">
  <meta name="twitter:description" content="清理linux服务器根目录空间 现象：代码无法复制到新文件，创建的新文件无法正常写入内容，大小保存后为0kb。无法上传新的文件。这说明根目录磁盘空间满了。
排查步骤 检查是否确实根目录空间满：">
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/posts/%E6%8E%92%E6%9F%A5linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A0%B9%E7%9B%AE%E5%BD%95%E7%A9%BA%E9%97%B4%E6%BB%A1%E7%9A%84%E9%97%AE%E9%A2%98/" /><link rel="prev" href="http://localhost:1313/posts/2025%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93-ds/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "排查linux服务器根目录空间满的问题",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/%E6%8E%92%E6%9F%A5linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A0%B9%E7%9B%AE%E5%BD%95%E7%A9%BA%E9%97%B4%E6%BB%A1%E7%9A%84%E9%97%AE%E9%A2%98\/"
        },"genre": "posts","keywords": "linux, 清理空间","wordcount":  1653 ,
        "url": "http:\/\/localhost:1313\/posts\/%E6%8E%92%E6%9F%A5linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A0%B9%E7%9B%AE%E5%BD%95%E7%A9%BA%E9%97%B4%E6%BB%A1%E7%9A%84%E9%97%AE%E9%A2%98\/","datePublished": "2026-01-07T00:00:00+00:00","dateModified": "2026-01-07T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Lennert"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="LenBlog"><span class="header-title-pre"><img src="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/lenLOGO.png" alt="" style="width: 40px; height: 40px;vertical-align: middle;margin-top: -8px;"></span>LenBlog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="LenBlog"><span class="header-title-pre"><img src="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/lenLOGO.png" alt="" style="width: 40px; height: 40px;vertical-align: middle;margin-top: -8px;"></span>LenBlog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">排查linux服务器根目录空间满的问题</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Lennert</a></span>&nbsp;<span class="post-category">included in <a href="/categories/%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>故障排查</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2026-01-07">2026-01-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1653 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#清理linux服务器根目录空间">清理linux服务器根目录空间</a>
          <ul>
            <li><a href="#排查步骤">排查步骤</a>
              <ul>
                <li><a href="#使用命令先查看根分区整体使用情况"><strong>使用命令先查看根分区整体使用情况</strong></a></li>
                <li><a href="#用-ncdu-可视化分析">用 ncdu 可视化分析</a></li>
                <li><a href="#分类清理--迁移">分类清理 / 迁移</a></li>
                <li><a href="#长期优化避免再次满盘">长期优化（避免再次满盘）</a>
                  <ul>
                    <li><a href="#不建议操作的文件夹系统核心目录">不建议操作的文件夹（系统核心目录）</a></li>
                    <li><a href="#通用操作流程所有可迁移文件夹都适用">通用操作流程（所有可迁移文件夹都适用）</a></li>
                    <li><a href="#关键规则避坑核心">关键规则（避坑核心）</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="清理linux服务器根目录空间">清理linux服务器根目录空间</h2>
<p>现象：代码无法复制到新文件，创建的新文件无法正常写入内容，大小保存后为0kb。无法上传新的文件。这说明根目录磁盘空间满了。</p>
<h3 id="排查步骤">排查步骤</h3>
<p>检查是否确实根目录空间满：</p>
<p><strong>ssh连接工具如MobaXterm可以设置右下角显示内存空间信息，随时进行观察。</strong><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071433691.png"
        data-srcset="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071433691.png, https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071433691.png 1.5x, https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071433691.png 2x"
        data-sizes="auto"
        alt="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071433691.png"
        title="image-20260107143304560" /></p>
<h4 id="使用命令先查看根分区整体使用情况"><strong>使用命令先查看根分区整体使用情况</strong></h4>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">df -h /</span></span></code></pre></div></div>
<p>输出重点看 <code>Use%</code>（使用率）和 <code>Avail</code>（可用空间），确认是否真的满了（Use%≥95%）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071437382.png"
        data-srcset="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071437382.png, https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071437382.png 1.5x, https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071437382.png 2x"
        data-sizes="auto"
        alt="https://picgo-lenblog.oss-cn-beijing.aliyuncs.com/lenblog/202601071437382.png"
        title="image-20260107143739501" /></p>
<p>这是根目录的使用情况。</p>
<p><strong>为什么/dev/nvme0n1p3 是根目录？</strong></p>
<blockquote>
<p>Linux 中所有硬件设备都以文件形式存在于 <code>/dev</code> 目录下，这个名称是 NVMe 固态硬盘的分区标识。<code>/dev/nvme0n1p3</code> 是第一块 NVMe 硬盘的第 3 个分区，<strong>它成为根目录的唯一原因是系统将其挂载到 <code>/</code> 挂载点</strong>；根目录（<code>/</code>）是逻辑概念，根分区（<code>/dev/nvme0n1p3</code>）是物理存储，二者通过 “挂载” 关联；</p></blockquote>
<h4 id="用-ncdu-可视化分析">用 ncdu 可视化分析</h4>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 安装ncdu（Ubuntu/Debian） </span>
</span></span><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt install -y ncdu 
</span></span><span class="line"><span class="cl"><span class="c1"># 扫描根分区，跳过无用系统目录（提速） </span>
</span></span><span class="line"><span class="cl">sudo ncdu -x / --exclude<span class="o">=</span>/proc --exclude<span class="o">=</span>/sys --exclude<span class="o">=</span>/dev</span></span></code></pre></div></div>
<p>扫描完成后，按 <code>↑/↓</code> 导航、<code>Enter</code> 进入子目录，直观看到各目录占用占比；</p>
<p>重点关注 <code>/tmp</code>、<code>/home</code>、<code>/var</code>、<code>/usr</code> 等目录（根分区的主要占用来源）。</p>
<h4 id="分类清理--迁移">分类清理 / 迁移</h4>
<table>
  <thead>
      <tr>
          <th>高占用目录</th>
          <th>典型内容</th>
          <th>处理方案（优先级从高到低）</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>/tmp</td>
          <td>程序临时文件、大文件夹</td>
          <td>1. 移动到大容量挂载盘（如 <code>/home/dl2/data</code>）；2. 确认无用后直接删除（<code>sudo rm -rf /tmp/xxx</code>）；3. 长期：建立软链接 <code>/tmp</code> → 大容量盘，避免再次占满。</td>
      </tr>
      <tr>
          <td>/home/xxx/anaconda3/miniconda3</td>
          <td>冗余 Conda 环境</td>
          <td>1. 用 <code>which conda</code> 确认当前使用的版本（如 miniconda3）；删除无用 Conda 环境：<code>conda env remove -n 环境名</code>。</td>
      </tr>
      <tr>
          <td>/var/log</td>
          <td>系统 / 应用日志</td>
          <td>删除旧日志（<code>sudo rm -rf /var/log/*.gz</code>）；</td>
      </tr>
      <tr>
          <td>/var/cache/apt/archives</td>
          <td>apt 安装包缓存</td>
          <td>清理：<code>sudo apt clean</code>（释放数 G 空间）。</td>
      </tr>
      <tr>
          <td>/var/lib/docker</td>
          <td>Docker 镜像 / 容器 / 日志占用</td>
          <td>查看 Docker 整体空间使用 docker system df</td>
      </tr>
  </tbody>
</table>
<h4 id="长期优化避免再次满盘">长期优化（避免再次满盘）</h4>
<p>这类文件夹的特点是：<strong>存储的是用户数据 / 临时数据 / 应用数据，不是系统核心文件</strong>，迁移后不影响系统启动和基础功能。</p>
<h5 id="不建议操作的文件夹系统核心目录">不建议操作的文件夹（系统核心目录）</h5>
<p>这类文件夹是系统启动 / 运行的核心，迁移 / 改软链接会导致系统崩溃，绝对不能动：</p>
<ul>
<li><code>/bin</code>、<code>/sbin</code>、<code>/lib</code>、<code>/lib64</code>（系统核心命令 / 库文件）；</li>
<li><code>/etc</code>（系统配置文件）；</li>
<li><code>/boot</code>（系统启动文件）；</li>
<li><code>/proc</code>、<code>/sys</code>、<code>/dev</code>（虚拟文件系统，不是实际存储）。</li>
</ul>
<h5 id="通用操作流程所有可迁移文件夹都适用">通用操作流程（所有可迁移文件夹都适用）</h5>
<p>不管是 Docker 目录、Conda 环境还是日志目录，都遵循 “<strong>迁移数据 → 建立链接 → 验证生效</strong>” 的三步逻辑，以迁移 <code>/var/lib/docker</code> 为例（可替换为其他目录）：</p>
<p>步骤 1：停止关联程序（避免文件被占用）</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 以 Docker 为例，先停止服务</span>
</span></span><span class="line"><span class="cl">sudo systemctl stop docker</span></span></code></pre></div></div>
<p>步骤 2：迁移原目录数据到大容量盘</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 1. 在大容量盘创建目标目录</span>
</span></span><span class="line"><span class="cl">sudo mkdir -p /home/dl2/data/docker
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. 迁移原目录数据（rsync 比 cp 更稳定，保留权限）</span>
</span></span><span class="line"><span class="cl">sudo rsync -avz /var/lib/docker/ /home/dl2/data/docker/</span></span></code></pre></div></div>
<p>步骤 3：备份并删除原目录（可选，确保干净）</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 备份原目录（防止迁移失败）</span>
</span></span><span class="line"><span class="cl">sudo mv /var/lib/docker /var/lib/docker.bak
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 或直接删除（确认迁移成功后）</span>
</span></span><span class="line"><span class="cl">sudo rm -rf /var/lib/docker</span></span></code></pre></div></div>
<p>步骤 4：建立软链接</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo ln -s /home/dl2/data/docker /var/lib/docker</span></span></code></pre></div></div>
<p>步骤 5：重启程序并验证</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-bash">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 重启 Docker 服务</span>
</span></span><span class="line"><span class="cl">sudo systemctl start docker
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 验证：查看目录属性（显示软链接）</span>
</span></span><span class="line"><span class="cl">ls -ld /var/lib/docker
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 验证：程序功能正常（如 Docker 拉取镜像）</span>
</span></span><span class="line"><span class="cl">docker pull ubuntu:latest</span></span></code></pre></div></div>
<h5 id="关键规则避坑核心">关键规则（避坑核心）</h5>
<p><strong>1.权限必须一致：</strong></p>
<p>迁移后的目录要和原目录权限完全相同（比如 <code>/var/lib/docker</code> 是 <code>root:root</code>，<code>/home/dl2/data/docker</code> 也要设置 <code>sudo chown root:root /home/dl2/data/docker</code>），否则程序会因权限不足报错。</p>
<p><strong>优先用软链接，特殊场景用绑定挂载</strong>：</p>
<ul>
<li>软链接（<code>ln -s</code>）：简单易操作，适合普通用户、非系统核心目录；</li>
<li>绑定挂载（<code>/etc/fstab</code> 配置）：更稳定，适合 Docker、数据库等对路径敏感的程序</li>
</ul>
<p><strong>先验证再删除原数据</strong>：</p>
<p>迁移后先启动程序、验证功能正常（比如 Docker 能运行容器、Conda 能激活环境），再删除原目录的备份（如 <code>/var/lib/docker.bak</code>），避免数据丢失。</p>
<p><strong>避免 “嵌套迁移”</strong>：</p>
<p>不要把 <code>/a/b</code> 迁移到 <code>/a/b/c</code>，也不要把 <code>/var/log</code> 迁移到 <code>/tmp</code>（如果 <code>/tmp</code> 已是软链接），会导致循环引用，程序无法访问。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2026-01-07</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/linux/">Linux</a>,&nbsp;<a href="/tags/%E6%B8%85%E7%90%86%E7%A9%BA%E9%97%B4/">清理空间</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2025%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93-ds/" class="prev" rel="prev" title="我的2025：在高压、自省与觉醒中穿行"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>我的2025：在高压、自省与觉醒中穿行</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2024 - 2026</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Lennert</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/css/_custom.scss"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/twemoji/twemoji.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script>window.config={"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script src="/js/theme.min.js"></script></body>
</html>
